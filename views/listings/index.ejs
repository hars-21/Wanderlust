<% layout('/layouts/boilerplate.ejs') %>
<style>
	#filter-bar {
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	#carouselExample {
		width: 70%;
	}

	.filter-contain {
		display: flex;
		flex-wrap: wrap;
		align-items: center;
		padding: 0 2.6rem;
	}

	.filter {
		text-align: center;
		margin-right: 1.85rem;
		margin-top: 2rem;
		opacity: 0.7;
	}

	.filter:hover {
		opacity: 1;
		cursor: pointer;
	}

	.filter p {
		font-size: 0.8rem;
	}

	#tax-info {
		display: none;
	}

	.tax-toggle,
	#filters {
		border: 1px solid rgba(0, 0, 0, 0.3);
		border-radius: 10px;
		padding: 1rem;
		height: 3rem;
		display: flex;
		align-items: center;
		font-size: 0.9rem;
	}

	.tax-toggle:hover,
	#filters:hover {
		cursor: pointer;
		border-color: rgba(0, 0, 0, 1);
		background-color: rgb(240, 240, 240);
	}

	.slider-btn {
		width: 5%;
	}

	.prev,
	.next {
		filter: invert(1);
	}
</style>

<div id="filter-bar">
	<div id="carouselExample" class="carousel slide">
		<div class="carousel-inner">
			<div class="carousel-item active">
				<div class="filter-contain">
					<div class="filter">
						<div>
							<i class="fa-solid fa-fire"></i>
						</div>
						<p>Trending</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-bed"></i>
						</div>
						<p>Rooms</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-mountain-city"></i>
						</div>
						<p>Iconic Cities</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-mountain"></i>
						</div>
						<p>Mountains</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-person-swimming"></i>
						</div>
						<p>Castles</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-fire"></i>
						</div>
						<p>Amazing Pools</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-campground"></i>
						</div>
						<p>Camping</p>
					</div>
					<div class="filter">
						<div>
							<i class="fa-solid fa-cow"></i>
						</div>
						<p>Farms</p>
					</div>
				</div>
			</div>
			<div class="carousel-item">
				<div class="filter-contain">
					<div class="filter">
						<div>
							<i class="fa-solid fa-snowflake"></i>
						</div>
						<p>Arctic</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-igloo"></i>
						</div>
						<p>Domes</p>
					</div>

					<div class="filter">
						<div>
							<i class="fa-solid fa-ship"></i>
						</div>
						<p>Boats</p>
					</div>
				</div>
			</div>
		</div>
		<button
			class="carousel-control-prev slider-btn"
			type="button"
			data-bs-target="#carouselExample"
			data-bs-slide="prev"
		>
			<span class="carousel-control-prev-icon prev" aria-hidden="true"></span>
			<span class="visually-hidden">Previous</span>
		</button>
		<button
			class="carousel-control-next slider-btn"
			type="button"
			data-bs-target="#carouselExample"
			data-bs-slide="next"
		>
			<span class="carousel-control-next-icon next" aria-hidden="true"></span>
			<span class="visually-hidden">Next</span>
		</button>
	</div>

	<div id="filters">
		<i class="fa-solid fa-filter"></i>
		&nbsp; Filters
	</div>

	<div class="tax-toggle">
		<div class="form-check-reverse form-switch">
			<input
				class="form-check-input"
				type="checkbox"
				role="switch"
				id="flexSwitchCheckDefault"
			/>
			<label class="form-check-label" for="flexSwitchCheckDefault"
				>Display total after taxes</label
			>
		</div>
	</div>
</div>

<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
	<% for(let listing of allListings){ %>
	<a href="/listings/<%= listing._id %>" class="listing-link">
		<div class="card col listing-card">
			<img
				src="<%= listing.image.url %>"
				class="card-img-top"
				alt="listing_image"
				style="height: 20rem"
			/>
			<div class="card-img-overlay"></div>
			<div class="card-body">
				<p class="card-text">
					<b><%= listing.title %></b> <br />
					<%= listing.price.toLocaleString("en-IN") %> / night
					<i id="tax-info">&nbsp; &nbsp; +18% GST</i>
				</p>
			</div>
		</div>
	</a>
	<% } %>
</div>

<script>
	let taxSwitch = document.querySelector("#flexSwitchCheckDefault");
	taxSwitch.addEventListener("click", () => {
		// let cards = document.querySelectorAll(".listing-card");
		// cards.forEach((card) => {
		// 	let cardText = card.querySelector(".card-text");
		// 	let price = cardText.innerText.split(" ")[0];
		// 	if (taxSwitch.checked) {
		// 		price = price * 1.18;
		// 		cardText.innerHTML = `<b>${
		// 			cardText.innerText
		// 		}</b> <br />${price.toLocaleString("en-IN")} / night`;
		// 	} else {
		// 		price = price / 1.18;
		// 		cardText.innerHTML = `<b>${
		// 			cardText.innerText
		// 		}</b> <br />${price.toLocaleString("en-IN")} / night`;
		// 	}
		// });

		let taxInfo = document.querySelectorAll("#tax-info");
		taxInfo.forEach((info) => {
			if (taxSwitch.checked) {
				info.style.display = "inline";
			} else {
				info.style.display = "none";
			}
		});
	});
</script>
